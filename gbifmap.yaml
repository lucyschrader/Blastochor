---
- core:
  label: core
  reference_column: null
  primary_endpoint: object
  explode: null
  reduce: null
  extend:
    - 1:
      endpoint: object
      path: id
      for_label: identification
    - 2:
      endpoint: fieldcollection
      path: evidenceFor.atEvent.id
      for_label: null
    - 3:
      endpoint: taxon
      path: identification.i.toTaxon.id
      for_label: null
    - 4:
      endpoint: agent
      path: evidenceFor.atEvent.recordedBy.i.id
      for_label: null
    - 5:
      endpoint: agent
      path: identification.i.identifiedBy.id
      for_label: null
  fields:
    - occurrenceID:
      - literal:
        - pid
    - type:
      - literal:
        - additionalType.i
    - created:
      - literal:
        - _meta.created
    - modified:
      - literal:
        - _meta.modified
    - language:
      - hardcoded:
        - en
    - license:
      - hardcoded:
        - Creative Commons Attribution 4.0 International license (CC BY 4.0)
    - rightsHolder:
      - hardcoded:
        - Museum of New Zealand Te Papa Tongarewa
    - accessRights:
      - hardcoded:
        - /!URL TO BE CREATED/!
    - bibliographicCitation:
      - literal:
        - captionFormatted
    - references:
      - format_string:
        - https://collections.tepapa.govt.nz/object/{}
        - id
    - institutionID:
      - hardcoded:
        - http://grscicoll.org/institution/museum-new-zealand-te-papa-tongarewa
    - collectionID:
      - hardcoded:
        - WELT
    - datasetID:
      - hardcoded:
        - tepapa:collection/dataset/plants
    - institutionCode:
      - hardcoded:
        - NMNZ
    - collectionCode:
      - hardcoded:
        - Plants
    - datasetName:
      - hardcoded:
        - Te Papa Plants collection specimens
    - ownerInstitutionCode:
      - hardcoded:
        - NMNZ
    - basisOfRecord:
      - literal:
        - basisOfRecord
    - informationWithheld:
      - literal:
        - restrictLocalityData
      - map_value:
          true: precise location information not given for threatened species
    - dataGeneralizations:
      - literal:
        - restrictLocalityData
      - map_value:
          true: coordinates and precise locality data removed
    - catalogNumber:
      - literal:
        - identifier
    - recordedBy:
      - collate_list:
        - evidenceFor.atEvent.recordedBy.i.title
    - recordedByID:
      - collate_list:
        - evidenceFor.atEvent.recordedBy.i.id
      - for_each:
        - lookup:
          - agent
        - conditional:
          - related.i.contentUrl
          - related.i.title=ORCID
      - concatenate:
        - null
    - sex:
      - literal:
        - sex
    - lifeStage:
      - literal:
        - lifeStage
    - occurrenceStatus:
      - hardcoded:
        - present
    - associatedMedia:
      - collate_list:
        - hasRepresentation.i.previewUrl
    - eventID:
      - literal:
        - evidenceFor.atEvent.pid
    - fieldNumber:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - fieldNumber
    - eventDate:
      - literal:
        - evidenceFor.atEvent.eventDate
    - verbatimEventDate:
      - literal:
        - evidenceFor.atEvent.verbatimEventDate
    - habitat:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - habitat
    - samplingProtocol:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - samplingProtocol
    - fieldNotes:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - fieldNotes
    - continent:
      - literal:
        - evidenceFor.atEvent.atLocation.continent
    - waterBody:
      - literal:
        - evidenceFor.atEvent.atLocation.waterBody
    - islandGroup:
      - literal:
        - evidenceFor.atEvent.atLocation.islandGroup
    - island:
      - literal:
        - evidenceFor.atEvent.atLocation.island
    - country:
      - literal:
        - evidenceFor.atEvent.atLocation.country
    - countryCode:
      - country_code:
        - evidenceFor.atEvent.atLocation.country
    - stateProvince:
      - literal:
        - evidenceFor.atEvent.atLocation.stateProvince
    - locality:
      - literal:
        - evidenceFor.atEvent.atLocation.locality
    - verbatimLocality:
      - literal:
        - evidenceFor.atEvent.atLocation.verbatimLocality
    - verbatimElevation:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.verbatimElevation
    - minimumElevationInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.minimumElevationInMeters
    - maximumElevationInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.maximumElevationInMeters
    - verbatimDepth:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.verbatimDepth
    - minimumDepthInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.minimumDepthInMeters
    - maximumDepthInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.maximumDepthInMeters
    - minimumDistanceAboveSurfaceInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.minimumDistanceAboveSurfaceInMeters
    - maximumDistanceAboveSurfaceInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.maximumDistanceAboveSurfaceInMeters
    - decimalLatitude:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - collate_list:
        - atLocation.mappingDetails.i.decimalLatitude
    - decimalLongitude:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - collate_list:
        - atLocation.mappingDetails.i.decimalLongitude
    - geodeticDatum:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - collate_list:
        - atLocation.mappingDetails.i.geodeticDatum
    - georeferenceSources:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.georeferenceSources
    - identificationID:
      - format_string:
        - tepapa:collection/identification/{}/{}
        - parent_id, explode_ordinal
    - identificationQualifier:
      - literal:
        - identification.i.qualifier
    - verbatimIdentification:
      - literal:
        - identification.i.qualifiedName
    - typeStatus:
      - format_string:
        - "{} of {}"
        - identification.i.typeStatus, identification.i.qualifiedName
        - required
    - identifiedBy:
      - literal:
        - identification.i.identifiedBy.title
    - identifiedByID:
      - literal:
        - identification.i.identifiedBy.id
      - lookup:
        - agent
      - conditional:
        - related.i.contentUrl
        - related.i.title=ORCID
    - dateIdentified:
      - literal:
        - identification.i.dateIdentified
    - taxonID:
      - literal:
        - identification.i.toTaxon.pid
    - scientificName:
      - literal:
        - identification.i.toTaxon.scientificName
    - taxonRank:
      - literal:
        - identification.i.toTaxon.rank
    - higherClassification:
      - literal:
        - identification.i.toTaxon.higherClassification
    - kingdom:
      - literal:
        - identification.i.toTaxon.kingdom
    - phylum:
      - literal:
        - identification.i.toTaxon.phylum
    - class:
      - literal:
        - identification.i.toTaxon.class
    - order:
      - literal:
        - identification.i.toTaxon.order
    - family:
      - literal:
        - identification.i.toTaxon.family
    - genus:
      - literal:
        - identification.i.toTaxon.genus
    - vernacularName:
      - literal:
        - identification.i
      - collate_list:
        - toTaxon.vernacularName.i.title
    - nomenclaturalCode:
      - literal:
        - identification.i.toTaxon.id
      - lookup:
        - taxon
      - literal:
        - nomenclaturalCode

- identification:
  label: identification
  reference_column: OccurrenceID
  primary_endpoint: object
  explode: identification
  reduce: identification
  extend: null
  fields:
    - identificationID:
      - format_string:
        - tepapa:collection/identification/{}/{}
        - parent_id, explode_ordinal
    - identificationQualifier:
      - literal:
        - qualifier
    - verbatimIdentification:
      - literal:
        - qualifiedName
    - typeStatus:
      - format_string:
        - "{} of {}"
        - typeStatus, qualifiedName
        - required
    - identifiedBy:
      - literal:
        - identifiedBy.title
    - identifiedByID:
      - literal:
        - identifiedBy.id
      - lookup:
        - agent
      - conditional:
        - related.i.contentUrl
        - related.i.title=ORCID
    - dateIdentified:
      - literal:
        - dateIdentified
    - taxonID:
      - literal:
        - toTaxon.pid
    - scientificName:
      - literal:
        - toTaxon.scientificName
    - taxonRank:
      - literal:
        - toTaxon.rank
    - higherClassification:
      - literal:
        - toTaxon.higherClassification
    - kingdom:
      - literal:
        - toTaxon.kingdom
    - phylum:
      - literal:
        - toTaxon.phylum
    - class:
      - literal:
        - toTaxon.class
    - order:
      - literal:
        - toTaxon.order
    - family:
      - literal:
        - toTaxon.family
    - genus:
      - literal:
        - toTaxon.genus
    - vernacularName:
      - collate_list:
        - toTaxon.vernacularName.i.title
    - nomenclaturalCode:
      - literal:
        - toTaxon.id
      - lookup:
        - taxon
      - literal:
        - nomenclaturalCode