---
- core:
  label: core
  reference_column: null
  primary_endpoint: object
  explode: null
  reduce: null
  extend:
    - 1:
      endpoint: object
      path: id
      for_label: identification, multimedia
    - 2:
      endpoint: fieldcollection
      path: evidenceFor.atEvent.id
      for_label: null
    - 3:
      endpoint: taxon
      path: identification.i.toTaxon.id
      for_label: null
    - 4:
      endpoint: agent
      path: evidenceFor.atEvent.recordedBy.i.id
      for_label: null
    - 5:
      endpoint: agent
      path: identification.i.identifiedBy.id
      for_label: null
  fields:
    - occurrenceID:
      - literal:
        - pid
    - type:
      - literal:
        - additionalType.i
    - created:
      - literal:
        - _meta.created
    - modified:
      - literal:
        - _meta.modified
    - language:
      - hardcoded:
        - en
    - license:
      - hardcoded:
        - Creative Commons Attribution 4.0 International license (CC BY 4.0)
    - rightsHolder:
      - hardcoded:
        - Museum of New Zealand Te Papa Tongarewa
    - accessRights:
      - hardcoded:
        - https://data.tepapa.govt.nz/docs/
    - references:
      - format_string:
        - https://collections.tepapa.govt.nz/object/{}
        - id
    - institutionID:
      - hardcoded:
        - http://grscicoll.org/institution/museum-new-zealand-te-papa-tongarewa
    - collectionID:
      - hardcoded:
        - WELT
    - datasetID:
      - hardcoded:
        - tepapa:collection/dataset/plants
    - institutionCode:
      - hardcoded:
        - NMNZ
    - collectionCode:
      - hardcoded:
        - Plants
    - datasetName:
      - hardcoded:
        - Te Papa Plants collection specimens
    - ownerInstitutionCode:
      - hardcoded:
        - NMNZ
    - basisOfRecord:
      - literal:
        - basisOfRecord
    - informationWithheld:
      - literal:
        - restrictLocalityData
      - map_value:
          true: precise location information not given for threatened species
    - dataGeneralizations:
      - literal:
        - restrictLocalityData
      - map_value:
          true: coordinates and precise locality data removed
    - catalogNumber:
      - literal:
        - identifier
    - recordNumber:
      - conditional:
        - previousIdentifier.i.identifier
        - previousIdentifier.i.notes=Collector's number|Collector number|Collector(s) number|collector number
    - recordedBy:
      - collate_list:
        - evidenceFor.atEvent.recordedBy.i.title
    - recordedByID:
      - collate_list:
        - evidenceFor.atEvent.recordedBy.i.id
      - for_each:
        - lookup:
          - agent
        - conditional:
          - related.i.contentUrl
          - related.i.title=ORCID
    - sex:
      - literal:
        - sex
    - lifeStage:
      - literal:
        - lifeStage
    - occurrenceStatus:
      - hardcoded:
        - present
    - preparations:
      - literal:
        - specimenType
    - otherCatalogNumbers:
      - conditional:
        - previousIdentifier.i.identifier
        - previousIdentifier.i.notes=Other institutions number
    - eventID:
      - literal:
        - evidenceFor.atEvent.pid
    - fieldNumber:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - fieldNumber
    - eventDate:
      - literal:
        - evidenceFor.atEvent.eventDate
    - verbatimEventDate:
      - literal:
        - evidenceFor.atEvent.verbatimEventDate
    - habitat:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - habitat
    - samplingProtocol:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - samplingProtocol
    - fieldNotes:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - fieldNotes
    - continent:
      - literal:
        - evidenceFor.atEvent.atLocation.continent
    - waterBody:
      - literal:
        - evidenceFor.atEvent.atLocation.waterBody
    - islandGroup:
      - literal:
        - evidenceFor.atEvent.atLocation.islandGroup
    - island:
      - literal:
        - evidenceFor.atEvent.atLocation.island
    - country:
      - literal:
        - evidenceFor.atEvent.atLocation.country
    - countryCode:
      - country_code:
        - evidenceFor.atEvent.atLocation.country
    - stateProvince:
      - literal:
        - evidenceFor.atEvent.atLocation.stateProvince
    - locality:
      - continue_if:
        - restrictLocalityData: false
      - literal:
        - evidenceFor.atEvent.atLocation.locality
    - verbatimElevation:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.verbatimElevation
    - minimumElevationInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.minimumElevationInMeters
    - maximumElevationInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.maximumElevationInMeters
    - verbatimDepth:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.verbatimDepth
    - minimumDepthInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.minimumDepthInMeters
    - maximumDepthInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.maximumDepthInMeters
    - minimumDistanceAboveSurfaceInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.minimumDistanceAboveSurfaceInMeters
    - maximumDistanceAboveSurfaceInMeters:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.maximumDistanceAboveSurfaceInMeters
    - decimalLatitude:
      - continue_if:
        - restrictLocalityData: false
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.mappingDetails.i.decimalLatitude
    - decimalLongitude:
      - continue_if:
        - restrictLocalityData: false
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.mappingDetails.i.decimalLongitude
    - geodeticDatum:
      - continue_if:
        - restrictLocalityData: false
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.mappingDetails.i.geodeticDatum
    - georeferenceSources:
      - literal:
        - evidenceFor.atEvent.id
      - lookup:
        - fieldcollection
      - literal:
        - atLocation.georeferenceSources
    - identificationID:
      - format_string:
        - tepapa:collection/identification/{}/{}
        - parent_id, identification.i.toTaxon.id
    - identificationQualifier:
      - identification_qualifier:
        - identification.i.toTaxon.id
        - identification.i.qualifier
    - verbatimIdentification:
      - literal:
        - identification.i.qualifiedName
    - typeStatus:
      - format_string:
        - "{} of {}"
        - identification.i.typeStatus, identification.i.toTaxon.scientificName
        - required
        - strip= (possible)
    - identifiedBy:
      - literal:
        - identification.i.identifiedBy.title
    - identifiedByID:
      - literal:
        - identification.i.identifiedBy.id
      - lookup:
        - agent
      - conditional:
        - related.i.contentUrl
        - related.i.title=ORCID
    - dateIdentified:
      - literal:
        - identification.i.dateIdentified
    - identificationRemarks:
      - literal:
        - identification.i.typeStatus
      - map_value:
          epitype (possible): Epitype status uncertain
          holotype (possible): Holotype status uncertain
          isolectotype (possible): Isolectotype status uncertain
          isoneotype (possible): Isoneotype status uncertain
          isoparatype (possible): Isoparatype status uncertain
          isosyntype (possible): Isosyntype status uncertain
          isotype (possible): Isotype status uncertain
          lectotype (possible): Lectotype status uncertain
          neotype (possible): Neotype status uncertain
          paralectotype (possible): Paralectotype status uncertain
          paratype (possible): Paratype status uncertain
          syntype (possible): Syntype status uncertain
          topotype (possible): Topotype status uncertain
          type (possible): Type status uncertain
    - taxonID:
      - literal:
        - identification.i.toTaxon.pid
    - scientificName:
      - literal:
        - identification.i.toTaxon.scientificName
    - taxonRank:
      - literal:
        - identification.i.toTaxon.rank
    - scientificNameAuthorship:
      - literal:
        - identification.i.toTaxon.id
      - lookup:
        - taxon
      - literal:
        - scientificNameAuthorshipSummary
    - higherClassification:
      - literal:
        - identification.i.toTaxon.higherClassification
    - kingdom:
      - literal:
        - identification.i.toTaxon.kingdom
    - phylum:
      - literal:
        - identification.i.toTaxon.phylum
    - class:
      - literal:
        - identification.i.toTaxon.class
    - order:
      - literal:
        - identification.i.toTaxon.order
    - family:
      - literal:
        - identification.i.toTaxon.family
    - subfamily:
      - literal:
        - identification.i.toTaxon.subfamily
    - genus:
      - literal:
        - identification.i.toTaxon.genus
    - subgenus:
      - literal:
        - identification.i.toTaxon.subgenus
    - specificEpithet:
      - literal:
        - identification.i.toTaxon.species
    - infraspecificEpithet:
      - literal:
        - identification.i.toTaxon.id
      - lookup:
        - taxon
      - literal:
        - subspecies
    - vernacularName:
      - literal:
        - identification.i
      - collate_list:
        - toTaxon.vernacularName.i.title
    - nomenclaturalCode:
      - literal:
        - identification.i.toTaxon.id
      - lookup:
        - taxon
      - literal:
        - nomenclaturalCode

- identification:
  label: identification
  reference_column: OccurrenceID
  primary_endpoint: object
  explode: identification
  reduce: identification
  extend: null
  fields:
    - identificationID:
      - format_string:
        - tepapa:collection/identification/{}/{}
        - parent_id, toTaxon.id
    - identificationQualifier:
      - identification_qualifier:
        - toTaxon.id
        - qualifier
    - verbatimIdentification:
      - literal:
        - qualifiedName
    - typeStatus:
      - format_string:
        - "{} of {}"
        - typeStatus, toTaxon.scientificName
        - required
        - strip= (possible)
    - identifiedBy:
      - literal:
        - identifiedBy.title
    - identifiedByID:
      - literal:
        - identifiedBy.id
      - lookup:
        - agent
      - conditional:
        - related.i.contentUrl
        - related.i.title=ORCID
    - dateIdentified:
      - literal:
        - dateIdentified
    - identificationRemarks:
      - literal:
        - typeStatus
      - map_value:
          epitype (possible): Epitype status uncertain
          holotype (possible): Holotype status uncertain
          isolectotype (possible): Isolectotype status uncertain
          isoneotype (possible): Isoneotype status uncertain
          isoparatype (possible): Isoparatype status uncertain
          isosyntype (possible): Isosyntype status uncertain
          isotype (possible): Isotype status uncertain
          lectotype (possible): Lectotype status uncertain
          neotype (possible): Neotype status uncertain
          paralectotype (possible): Paralectotype status uncertain
          paratype (possible): Paratype status uncertain
          syntype (possible): Syntype status uncertain
          topotype (possible): Topotype status uncertain
          type (possible): Type status uncertain
    - taxonID:
      - literal:
        - toTaxon.pid
    - scientificName:
      - literal:
        - toTaxon.scientificName
    - taxonRank:
      - literal:
        - toTaxon.rank
    - scientificNameAuthorship:
      - literal:
        - toTaxon.id
      - lookup:
        - taxon
      - literal:
        - scientificNameAuthorshipSummary
    - higherClassification:
      - literal:
        - toTaxon.higherClassification
    - kingdom:
      - literal:
        - toTaxon.kingdom
    - phylum:
      - literal:
        - toTaxon.phylum
    - class:
      - literal:
        - toTaxon.class
    - order:
      - literal:
        - toTaxon.order
    - family:
      - literal:
        - toTaxon.family
    - subfamily:
      - literal:
        - toTaxon.subfamily
    - genus:
      - literal:
        - toTaxon.genus
    - subgenus:
      - literal:
        - toTaxon.subgenus
    - specificEpithet:
      - literal:
        - toTaxon.species
    - infraspecificEpithet:
      - literal:
        - toTaxon.id
      - lookup:
        - taxon
      - literal:
        - subspecies
    - vernacularName:
      - collate_list:
        - toTaxon.vernacularName.i.title
    - nomenclaturalCode:
      - literal:
        - toTaxon.id
      - lookup:
        - taxon
      - literal:
        - nomenclaturalCode

- multimedia:
  label: multimedia
  reference_column: OccurrenceID
  primary_endpoint: object
  explode: hasRepresentation
  reduce: null
  extend: null
  requires:
    hasRepresentation.i.rights.allowsDownload: true
    restrictLocalityData: false
  fields:
    - type:
      - literal:
        - hasRepresentation.i.additionalType
      - must_match:
        - StillImage, Sound, MovingImage
    - format:
      - hardcoded:
        - image/jpeg
    - identifier:
      - literal:
        - hasRepresentation.i.thumbnailUrl
    - references:
      - format_string:
        - https://collections.tepapa.govt.nz/object/{}
        - id
    - title:
      - literal:
        - title
    - publisher:
      - hardcoded:
        - Museum of New Zealand Te Papa Tongarewa
    - license:
      - literal:
        - hasRepresentation.i.rights.title
    - rightsHolder:
      - literal:
        - hasRepresentation.i.rights.title
      - map_value:
          No Known Copyright Restrictions: null
          CC BY-NC-ND 4.0: Museum of New Zealand Te Papa Tongarewa
          CC BY 4.0: Museum of New Zealand Te Papa Tongarewa
          All Rights Reserved: Museum of New Zealand Te Papa Tongarewa